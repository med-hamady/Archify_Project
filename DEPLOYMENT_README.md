# üöÄ Archify - Plateforme √âducative ISCAE

## üìä Status du D√©ploiement

| Composant | Plateforme | URL | Status |
|-----------|------------|-----|--------|
| **Frontend** | Vercel | https://archify-project.vercel.app | üü¢ D√©ploy√© |
| **Backend** | Render | https://archify-backend.onrender.com | üü¢ D√©ploy√© |
| **Database** | Render PostgreSQL | (priv√©e) | üü¢ Actif |
| **API** | Render | https://archify-backend.onrender.com/api | üü¢ Live |

---

## üéØ Vue d'Ensemble

**Archify** est une plateforme d'apprentissage en ligne d√©velopp√©e pour les √©tudiants d'ISCAE, offrant des cours gratuits et premium avec syst√®me d'abonnement.

### Fonctionnalit√©s Principales

‚úÖ Catalogue de cours (gratuits et premium)
‚úÖ Authentification (inscription/connexion)
‚úÖ Lecture vid√©o en streaming
‚úÖ Syst√®me d'abonnement (300 DH / 6 mois)
‚úÖ Paiement manuel avec screenshot
‚úÖ Interface administrateur compl√®te
‚úÖ Gestion des cours et le√ßons
‚úÖ Validation manuelle des paiements
‚úÖ Commentaires sur les cours

---

## üèóÔ∏è Architecture

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ           GitHub Repository                   ‚îÇ
‚îÇ        (Source de v√©rit√©)                     ‚îÇ
‚îÇ     github.com/med-hamady/Archify_Project     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚îÇ                    ‚îÇ
              ‚îÇ Auto-deploy        ‚îÇ Auto-deploy
              ‚îÇ (on push)          ‚îÇ (on push)
              ‚ñº                    ‚ñº
       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
       ‚îÇ   Vercel   ‚îÇ       ‚îÇ   Render   ‚îÇ
       ‚îÇ  Frontend  ‚îÇ‚óÑ‚îÄAPI‚îÄ‚îÄ‚îÇ  Backend   ‚îÇ
       ‚îÇ  (Angular) ‚îÇ       ‚îÇ  (Node.js) ‚îÇ
       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                 ‚îÇ
                                 ‚îÇ SQL
                                 ‚ñº
                            ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                            ‚îÇ PostgreSQL ‚îÇ
                            ‚îÇ   Render   ‚îÇ
                            ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üõ†Ô∏è Technologies

### Frontend
- **Framework** : Angular 20
- **UI** : Angular Material
- **Routing** : Angular Router
- **HTTP** : HttpClient
- **H√©bergement** : Vercel

### Backend
- **Runtime** : Node.js 20
- **Framework** : Express.js
- **ORM** : Prisma
- **Database** : PostgreSQL 16
- **Auth** : JWT + bcrypt
- **Upload** : Multer
- **H√©bergement** : Render (Docker)

---

## üìö Documentation

| Document | Description |
|----------|-------------|
| [DEPLOYMENT_SUCCESS.md](DEPLOYMENT_SUCCESS.md) | üéâ R√©sum√© complet du d√©ploiement r√©ussi |
| [DEPLOY_RENDER.md](DEPLOY_RENDER.md) | üöÄ Guide de d√©ploiement sur Render |
| [FRONTEND_BACKEND_CONNECTION.md](FRONTEND_BACKEND_CONNECTION.md) | üîó Configuration frontend-backend |
| [RENDER_ENV_VARS_UPDATE.md](RENDER_ENV_VARS_UPDATE.md) | ‚ö†Ô∏è Variables d'environnement CORS (IMPORTANT) |
| [TESTING_CHECKLIST.md](TESTING_CHECKLIST.md) | ‚úÖ Checklist de tests end-to-end (64 tests) |
| [DEPLOYMENT_VERCEL.md](DEPLOYMENT_VERCEL.md) | üì¶ D√©ploiement frontend sur Vercel |
| [RAILWAY_CLI_DEPLOY.md](RAILWAY_CLI_DEPLOY.md) | üöÇ Archive : Tentatives Railway |
| [RAILWAY_TROUBLESHOOTING.md](RAILWAY_TROUBLESHOOTING.md) | üîß Archive : D√©pannage Railway |

---

## üöÄ Quick Start

### 1. ‚ö†Ô∏è ACTION IMM√âDIATE REQUISE

**Avant de tester l'application**, vous DEVEZ configurer la variable CORS sur Render :

1. Aller sur : https://dashboard.render.com
2. Service : `archify-backend`
3. Section : "Environment"
4. Ajouter : `CORS_ORIGINS` = `https://archify-project.vercel.app,http://localhost:4200`
5. Sauvegarder (Render red√©ploiera automatiquement)

**üìñ Voir d√©tails** : [RENDER_ENV_VARS_UPDATE.md](RENDER_ENV_VARS_UPDATE.md)

---

### 2. V√©rifier le Backend

```bash
curl https://archify-backend.onrender.com/healthz
```

**R√©sultat attendu** :
```json
{"status":"ok"}
```

---

### 3. Tester le Frontend

1. Ouvrir : https://archify-project.vercel.app
2. V√©rifier que la page se charge
3. Ouvrir DevTools (F12) ‚Üí Console
4. V√©rifier qu'il n'y a **aucune erreur CORS**

---

### 4. Tests End-to-End

Suivre la checklist compl√®te : [TESTING_CHECKLIST.md](TESTING_CHECKLIST.md)

**Tests prioritaires** :
- ‚úÖ Catalogue de cours visible
- ‚úÖ Inscription/Connexion fonctionne
- ‚úÖ Lecture vid√©o cours gratuit
- ‚úÖ Soumission paiement
- ‚úÖ Interface admin accessible

---

## üîê Acc√®s Admin

Pour cr√©er un compte administrateur, vous devez le faire manuellement dans la base de donn√©es :

### Option 1 : Via Render Shell (Plan payant requis)

```bash
# Se connecter √† la base de donn√©es
psql $DATABASE_URL

# Mettre √† jour un utilisateur existant
UPDATE "User" SET role = 'ADMIN' WHERE email = 'votre-email@example.com';
```

### Option 2 : Via Client PostgreSQL Local

1. R√©cup√©rer `DATABASE_URL` depuis Render
2. Se connecter :
   ```bash
   psql "postgresql://archify:password@host/database"
   ```
3. Ex√©cuter la m√™me requ√™te UPDATE

### Option 3 : Cr√©er un Script de Seed

Cr√©er `backend/prisma/seed-admin.ts` (√† venir si n√©cessaire)

---

## üîÑ Workflow de D√©veloppement

### Faire des Modifications

```bash
# 1. Travailler localement
cd backend  # ou cd frontend
npm run dev

# 2. Tester localement
# Backend : http://localhost:3000
# Frontend : http://localhost:4200

# 3. Commiter
git add .
git commit -m "Description des changements"

# 4. Pousser
git push origin main

# 5. Attendre le d√©ploiement automatique (2-5 min)
# Vercel et Render d√©tectent et d√©ploient automatiquement
```

---

### Mettre √† Jour le Sch√©ma de Base de Donn√©es

```bash
cd backend

# 1. Modifier prisma/schema.prisma

# 2. Cr√©er une migration
npx prisma migrate dev --name nom_migration

# 3. Commiter les fichiers de migration
git add prisma/migrations
git commit -m "db: Add migration nom_migration"
git push origin main

# 4. Render ex√©cute automatiquement `npx prisma migrate deploy`
```

---

## üìä Monitoring

### Render Dashboard
- **Logs** : Voir les logs en temps r√©el
- **Metrics** : CPU, RAM, Requests
- **Events** : D√©ploiements, erreurs, red√©marrages

### Vercel Dashboard
- **Deployments** : Historique des d√©ploiements
- **Analytics** : Visiteurs, performances
- **Logs** : Logs des fonctions (si applicable)

---

## ‚ö†Ô∏è Limitations Connues

### Render Free Tier

| Limitation | Impact | Solution |
|------------|--------|----------|
| Service s'endort apr√®s 15 min | Premi√®re requ√™te : 30-60s | Attendre le r√©veil ou passer au plan payant |
| 750 heures/mois | Service peut s'arr√™ter fin de mois | Passer au Starter Plan ($7/mois) |
| Pas de Shell | Commandes manuelles impossibles | Automatiser via Start Command |

### Vercel Free Tier

| Limitation | Impact |
|------------|--------|
| 100 GB bandwidth/mois | Suffisant pour usage normal |
| Pas de fonctions serverless backend | N/A (backend sur Render) |

---

## üêõ D√©pannage

### Erreur CORS dans le navigateur

**Sympt√¥me** :
```
Access to fetch at '...' from origin '...' has been blocked by CORS policy
```

**Solution** : V√©rifier que `CORS_ORIGINS` est configur√© sur Render
**Voir** : [RENDER_ENV_VARS_UPDATE.md](RENDER_ENV_VARS_UPDATE.md)

---

### Backend timeout / Network Error

**Sympt√¥me** : Requ√™tes API √©chouent ou prennent > 60 secondes

**Cause** : Backend Render endormi (plan gratuit)

**Solution** :
1. Attendre 30-60 secondes
2. Rafra√Æchir la page
3. Le backend se r√©veille automatiquement

---

### Vid√©os ne jouent pas

**Sympt√¥me** : Erreur lors de la lecture vid√©o

**Solutions possibles** :
1. V√©rifier que le cours/le√ßon existe
2. V√©rifier l'abonnement utilisateur (si cours premium)
3. V√©rifier les logs Render pour erreurs vid√©o
4. V√©rifier que le fichier vid√©o est bien upload√©

---

### Migrations √©chouent

**Sympt√¥me** : Erreur lors du d√©ploiement Render

**Solutions** :
1. V√©rifier la syntaxe du schema Prisma
2. V√©rifier la compatibilit√© PostgreSQL
3. Voir les logs Render pour l'erreur exacte

---

## üìà Prochaines √âtapes (Optionnel)

### Am√©liorations Recommand√©es

- [ ] Configurer un domaine personnalis√© (ex: `archify.iscae.ma`)
- [ ] Ajouter Google Analytics pour tracking
- [ ] Configurer Sentry pour monitoring d'erreurs
- [ ] Mettre en place des tests automatis√©s (Playwright/Cypress)
- [ ] Ajouter un CDN pour les vid√©os (Cloudflare, AWS S3)
- [ ] Configurer des alertes email (Render + Vercel)
- [ ] Impl√©menter un syst√®me de cache Redis
- [ ] Ajouter des webhooks pour notifications

### √âvolutivit√©

- [ ] Passer au plan payant Render ($7/mois) pour pas de sleep
- [ ] Impl√©menter un syst√®me de paiement automatis√© (Stripe, PayPal)
- [ ] Ajouter un syst√®me de notifications in-app
- [ ] Impl√©menter des certificats de fin de cours
- [ ] Ajouter un forum de discussion

---

## üë• √âquipe

**D√©veloppeur** : [Votre nom]
**Institution** : ISCAE
**Framework** : Angular + Node.js + PostgreSQL
**Deployment** : Vercel + Render

---

## üìû Support

### Issues GitHub
Pour signaler des bugs ou demander des fonctionnalit√©s :
https://github.com/med-hamady/Archify_Project/issues

### Documentation
Toute la documentation est dans le repository :
- `/DEPLOYMENT_*.md` - Documentation de d√©ploiement
- `/FRONTEND_BACKEND_CONNECTION.md` - Configuration
- `/TESTING_CHECKLIST.md` - Tests

---

## üìù Changelog

### Version 1.0 - 16 octobre 2025

**üéâ D√©ploiement Initial Production**

**Frontend (Vercel)** :
- ‚úÖ Angular 20 application d√©ploy√©e
- ‚úÖ Configuration production pointant vers Render
- ‚úÖ Auto-d√©ploiement configur√© depuis GitHub

**Backend (Render)** :
- ‚úÖ Node.js/Express API d√©ploy√©e
- ‚úÖ PostgreSQL database cr√©√©e et migr√©e
- ‚úÖ Docker containerization
- ‚úÖ Auto-d√©ploiement configur√© depuis GitHub
- ‚úÖ Health check endpoint fonctionnel

**Fonctionnalit√©s** :
- ‚úÖ Authentification JWT
- ‚úÖ Gestion de cours et le√ßons
- ‚úÖ Upload et streaming vid√©o
- ‚úÖ Syst√®me d'abonnement
- ‚úÖ Paiement manuel avec screenshot
- ‚úÖ Interface admin compl√®te
- ‚úÖ Commentaires sur cours

---

## üìÑ License

Projet priv√© - ISCAE

---

## ‚úÖ Statut Final

**üü¢ Production Ready**

‚úÖ Backend d√©ploy√© et fonctionnel
‚úÖ Frontend d√©ploy√© et fonctionnel
‚úÖ Base de donn√©es configur√©e
‚úÖ Migrations appliqu√©es
‚úÖ Auto-d√©ploiement configur√©
‚úÖ Documentation compl√®te
‚è≥ Tests end-to-end √† effectuer
‚è≥ Variable CORS √† configurer sur Render (critique)

---

**Derni√®re mise √† jour** : 16 octobre 2025
**Version** : 1.0
**Auteur** : Med Hamady (via Claude Code)
